{
  "tasks": [
    {
      "name": "Codegen",
      "steps": [
        {
          "name": "Copy Gdk Packages Schema",
          "command": "dotnet",
          "arguments": [
            "run",
            "-p",
            "../../tools/CopySchema/CopySchema.csproj",
            "Packages/manifest.json",
            "../../schema"
          ]
        },
        {
          "name": "C#",
          "arguments": [
            "process_schema",
            "generate",
            "--cachePath=.spatialos/schema_codegen_cache_usr",
            "--output=Assets/improbable/generated",
            "--language=csharp"
          ]
        },
        {
          "name": "Json AST",
          "arguments": [
            "process_schema",
            "generate",
            "--cachePath=.spatialos/schema_codegen_cache_json_usr",
            "--output=improbable/json/usr",
            "--language=ast_json"
          ]
        },
        {
          "name": "GDK Codegen",
          "command": "dotnet",
          "arguments": [
              "run",
              "-p",
              "../../code_generator/GdkCodeGenerator/GdkCodeGenerator.csproj",
              "--json-dir=./improbable/json/usr",
              "--output-dir=./Assets/Generated/"
          ]
        }
      ]
    },
    {
      "name": "Build",
      "steps": [
        {
          "name": "Codegen",
          "arguments": [
            "invoke-task",
            "Codegen"
          ]
        },
        {
          "name": "Artifact",
          "command": "dotnet",
          "arguments": [
            "run",
            "-p",
            "../../tools/RunUnity/RunUnity.csproj",
            "-batchmode",
            "-quit",
            "-logfile",
            "../../logs/${IMPROBABLE_WORKER_NAME}/unity_invoke.log",
            "-projectPath",
            "${IMPROBABLE_WORKER_DIR}",
            "-executeMethod",
            "Improbable.Gdk.Legacy.BuildSystem.WorkerBuilder.Build",
            "+buildWorkerTypes",
            "UnityClient",
            "+buildTarget",
            "\"${IMPROBABLE_BUILD_TARGET}\""
          ]
        }
      ]
    },
    {
      "name": "Clean",
      "steps": [
        {
          "name": "Codegen",
          "command": "rm",
          "arguments": [
            "-rf",
            "Assets/improbable/genereated/*"
          ]
        }
      ]
    }
  ]
}